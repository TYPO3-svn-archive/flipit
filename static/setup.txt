
  ///////////////////////////////////////////////////////////////
  //
  // INDEX
  //
  // includeLibs
  // plugin.tx_flipit
  // tt_content.uploads
  // flipit_ajax



  ///////////////////////////////////////////////////////////////
  //
  // includeLibs

includeLibs {
  tx_browser_cssstyledcontent = EXT:flipit/lib/typoscript/class.tx_flipit_typoscript.php
}
  // includeLibs



  ///////////////////////////////////////////////////////////////
  //
  // plugin.tx_flipit

plugin.tx_flipit {
    // For tt_content.uploads
  master_templates =
  master_templates {
      // Please copy to tt_content.uploads.20.itemRendering
    flip_it = USER
    flip_it {
        // enabled, content
      userFunc = tx_flipit_typoscript->main
      userFunc {
          // currentTable, tables
        configuration =
        configuration {
            // [String] table
          currentTable = {$plugin.tx_flipit.database.table} 
            // [String/CSV] Comma separated list of file types for SWF conversion. Possible types: jpg, pdf, png
          filetypes = {$plugin.tx_flipit.configuration.filetypes} 
            // tt_content, tx_org_downloads
          tables =
          tables {
              // media, tstamp
            tt_content =
            tt_content {
              media   = media
              tstamp  = tstamp
            }
              // media, tstamp
            tx_org_downloads =
            tx_org_downloads {
              media   = tstamp
              tstamp  = tstamp
            }
          }
            // [String] disabled, enabled
          updateSwfXml = COA
          updateSwfXml {
            if {
              value = disabled,enabled,ts
              isInList {
                field = tx_flipit_updateswfxml
              }
            }
              // disabled || enabled
            10 = TEXT
            10 {
              if {
                value = disabled,enabled
                isInList {
                  field = tx_flipit_updateswfxml
                }
              }
              field = tx_flipit_updateswfxml
            }
              // ts
            20 = TEXT
            20 {
              if {
                value = ts
                equals {
                  field = tx_flipit_updateswfxml
                }
              }
              value = {$plugin.tx_flipit.configuration.updateswfxml} 
            }
          }

            // Configuration of the XML file, which controls the flash output
          xml =
          xml {
              // Document width: Width in pixel (if autodetection failes)
            width = TEXT
            width {
              value = {$plugin.tx_flipit.xml.width}
            }
              // Document height: Height in pixel (if autodetection failes)
            height = TEXT
            height {
              value = {$plugin.tx_flipit.xml.height}
            }
              // Colour of buttons:
            buttoncolor = TEXT
            buttoncolor {
              value = {$plugin.tx_flipit.xml.buttoncolor}
            }
              // Colour of the panel:
            panelcolor = TEXT
            panelcolor {
              value = {$plugin.tx_flipit.xml.panelcolor}
            }
              // Colour of the font:
            textcolor = TEXT
            textcolor {
              value = {$plugin.tx_flipit.xml.textcolor}
            }
              // Colour of the background:
            backgroundcolor = TEXT
            backgroundcolor {
              value = {$plugin.tx_flipit.xml.backgroundcolor}
            }
              // Hardcorver: If set to ture, fist and last page are hard covered.
            hcover = TEXT
            hcover {
              value = {$plugin.tx_flipit.xml.hcover}
            }
              // Goto label: default language (English)
              // Goto label: German language
            gotolabel = TEXT
            gotolabel {
              value = {$plugin.tx_flipit.xml.gotolabel.default}
              lang {
                de = {$plugin.tx_flipit.xml.gotolabel.de}
                en = {$plugin.tx_flipit.xml.gotolabel.default}
              }
            }
          }
        }
          // Checks, if Flip it! is enabled
        enabled = COA
        enabled {
            // Error prompt, if enabled mode isn't an element of the list disabled,enabled,ts
          10 = TEXT
          10 {
            if {
              value = disabled,enabled,ts
              isInList {
                field = tx_flipit_enabled
              }
              negate = 1
            }
            value (
              <div style="background:white;border:1em solid red;color:red;padding:1em;text-align:center;">
                <h1>TypoScript Error</h1>
                <p>
                  '{field:tx_flipit_enabled}' isn't any element of the list: disabled,enabled,ts
                </p>
                <p>
                  Browser - TYPO3 without PHP
                </p>
              </div>
)
            lang.de (
              <div style="background:white;border:1em solid red;color:red;padding:1em;text-align:center;">
                <h1>TypoScript Fehler</h1>
                <p>
                  '{field:tx_flipit_enabled}' ist kein Element der Liste: disabled,enabled,ts
                </p>
                <p>
                  Browser - TYPO3 ohne PHP
                </p>
              </div>
)
            insertData = 1
          }
          20 = COA
          20 {
            if {
              value = disabled,enabled,ts
              isInList {
                field = tx_flipit_enabled
              }
            }
              // disabled || enabled
            10 = TEXT
            10 {
              if {
                value = disabled,enabled
                isInList {
                  field = tx_flipit_enabled
                }
              }
              field = tx_flipit_enabled
            }
              // ts
            20 = TEXT
            20 {
              if {
                value = ts
                equals {
                  field = tx_flipit_enabled
                }
              }
              value = {$plugin.tx_flipit.configuration.enable}
            }
          }
        }
          // Content will rendered, if Flip it! is enabled
        content = COA
        content {
          10 = TEXT
          10 {
            value (
              <script src="typo3conf/ext/flipit/res/jss/swfobjects_1.4.4/swfobject.js" type="text/javascript"></script>
)
          }
          20 = TEXT
          20 {
            value ( 
              <div id="c{field:uid}_flipit" style="width:{$plugin.tx_flipit.html.width}; height:{$plugin.tx_flipit.html.height};">
                <p>
                  To view Flip it!, you need the latest <a href="http://adobe.com/go/getflashplayer">Flash player</a>
                </p>
              </div>
              <script type="text/javascript">
                var so = new SWFObject("typo3conf/ext/flipit/res/swf/book.swf", "book", "100%", "100%", "8", "{$plugin.tx_flipit.html.color.background}");
                so.addVariable("xmlFile","uploads/tx_flipit/{field:tx_flipit_xml_file}?{field:tstamp}");
                so.addVariable("fullscreen","true");
                so.write("c{field:uid}_flipit");
              </script>
)
            insertData = 1
          }
        }
      }
    } 
  }
  pageObjects {
    page = PAGE
    page {
      typeNum = {$plugin.tx_flipit.typeNum.ajaxPageObj}
      config {
        disableAllHeaderCode  = 1
        xhtml_cleaning        = 0
        admPanel              = 0
      }
      10 = CONTENT
      10 {
        table = {$plugin.tx_flipit.database.table}
        select {
            // use current language
          languageField = sys_language_uid
          andWhere {
            cObject = COA
            cObject {
                // uid = GP:tx_flipit|uid
              10 = TEXT
              10 {
                data = GP:tx_flipit|uid
                wrap = uid= |
              }
                // pid = 
              20 = TEXT
              20 {
                dataWrap = pid={page:uid}
              }
            }
          }
        }
      }
      20 = COA
      20 {
          // uid = GP:tx_flipit|uid
        10 = TEXT
        10 {
          data = GP:tx_flipit|uid
          wrap = uid= |
        }
          // pid = 
        20 = TEXT
        20 {
          dataWrap = pid={page:uid}
        }
      }
    }
  }
}
  // plugin.tx_flipit



  ///////////////////////////////////////////////////////////////
  //
  // tt_content.uploads

tt_content.uploads {
  20 {
      // Don't outerWrap the thumbnail with <table> by default
    outerWrap = |
    itemRendering >
    itemRendering < plugin.tx_flipit.master_templates.flip_it
  }
}
  // tt_content.uploads



  ///////////////////////////////////////////////////////////////
  //
  // pages: Flipt it! Ajax

  // Flip it! ajax page object. In case of localisation: Configure the id of sys_languagein the Constant Editor. Move in this line ...jQuery.default to ...jQuery.de (i.e.)
flipit_ajax < plugin.tx_flipit.pageObjects.page

[globalVar = GP:type = {$plugin.tx_flipit.typeNum.ajaxPageObj}]
    // Don't handle header of content element
  lib.stdheader >
[global]
  // pages: Flipt it! Ajax
